https://github.com/meti-dx-team/METI-Digital-Tools

2. 適切にツールを管理し、安全に運⽤するための管理サービス導⼊実証
2 - 1 . 基本⽅針
本章では、DX オフィスが業務遂⾏するインフラを設計する上での基本⽅針を⽰す。
基本⽅針は、DX オフィスが⽬指す実現構想を、多様な観点から⽬的、内容、⽅法をより具体化したものであ
る。
【 DX オフィスが⽬指す構想 】
• インフラ管理の⼯数を最⼩化し、効率的かつ合理的に管理する
• 従来型の境界防御ではなく、クラウドファーストの観点でツール・セキュリティを検討する
• ツール利⽤者の適切な ID 管理を⾏う
• 適切なアクセス制限とセキュリティ機構を実装し、業務を安全に⾏うに⾜る環境を構築する
• ツールの利⽤状況を追跡可能とする
• ツール上のデータを安全に保護する
基本⽅針に沿ったアーキテクチャを考えるに先⽴ち、まずは現在のセキュリティ事情を考慮した業務インフラ
について⼀般論を述べる。
2-1-1 . モダンかつセキュアな業務インフラの考え⽅
従来、組織における業務インフラは、ファイアウォールや IPS/IDS、プロキシーサーバー、VPN、閉域網に
代表されるネットワーク境界により保護されており、境界内のセキュリティは保たれているものとされてきた。
また、組織にて利⽤可能なアプリケーションをホワイトリストで制御し、当該ファイルを暗号化することで、デ
ータの保護がなされているものとしてきた。これらの従来型のセキュリティ施策は、限られた範囲内においては
依然として有効だと考えられる。
8
⼀⽅で、近年の業務は境界内に留まらずに SaaS をはじめとするインターネット上のリソースの活⽤が進んで
いる。また、COVID-19 への対応のために⾃宅やサテライトオフィスなど、組織ネットワーク外での業務を余儀
なくされている現状は、業務を既存のネットワーク境界内で⾏うことをより困難にしている。そのため、現代の
組織の業務インフラは、ネットワーク境界に依存しないセキュリティ施策が求められている状況にある。
組織のネットワークインフラは、セキュリティの境界をエンドポイント（端末）まで引き下げ、セキュリティ
を接続するネットワークに依存しない構成とする必要がある。また、ID と認証認可を制御し、エンドポイント
を無条件に信頼することなく、エンドポイントの状態やコンテキスト（利⽤ブラウザやユーザーエージェントの
変遷、地理的情報など）を動的に判断することが必要である。
これらは、ゼロトラストアーキテクチャの⼀部である。ゼロトラストアーキテクチャは概念であり、現在の技
術ではその全ての要素を実装することはできない。これは、現⾏業務で利⽤している既存システムのほとんどま
たは全てが、ゼロトラストアーキテクチャを前提に構成されておらず、境界型ネットワーク構成となっているた
めである。
そのため、組織のネットワークインフラは、現在利⽤可能な技術を⽤いて、ゼロトラストアーキテクチャの概
念を取り込んだ構成とすることが現実解となる。
本節では、モダンかつセキュアな業務インフラの構成要素について解説する。
n 認証認可
制御された ID の認証認可を⾏うために、さまざまなクラウドサービスに対して、識別可能な個⼈に紐づくユ
ニークな ID を⽤いて⾏う必要がある。
これは、単⼀の IAM（Identity and Access Management）をソースとする IDaaS（Identity as a Service）か
ら、SAML（Security Assertion Markup Language）、SCIM（System for Cross-domain Identity
Management）、OIDC（OpenID Connect）、API（Application Programming Interface）を⽤いて各サービスに
プロビジョニングすることで実現する。
IDaaS はクラウドサービスに対するユーザーの認証を⾏い、SaaS へのアクセスを認可する。このとき、ユー
ザーに与えられる認可レベルは、IDaaS のグループメンバーシップにもとづいて定義できる。
このように、SaaS への全てのユーザー認証を IAM へ集約することで、誰が・いつ認証し、どの SaaS に対し
て・どの権限で認可したのかを制御できる。
n 端末認証
端末認証は、組織に登録された端末であることの確認と判断を⾏う認証である。端末認証は、端末に配布され
ている証明書（X.509 証明書など）を⽤いて⾏われる。組織が発⾏した証明書を端末が保持しているかどうか
で、組織が保有する端末かどうか判定が可能となる。端末認証に⽤いる証明書は、窃取されることで、その正当
性が危殆化される恐れがある。そのため、証明書の発⾏・配布・保管・更新・失効プロセスに⼈が介在しないよ
う、システムによってメンテナンスされる必要がある。端末に対して MDM を構成することで、それらのプロセ
スをシステムにより⾃動的に⾏うことが可能となる。
このように適切にメンテナンスされた証明書を⽤いて⾏う認証は、その組織で管理された端末を⽤いて認証し
ている証明をできる。
9
n 端末の健全性
セキュリティの境界をエンドポイントに引き下げるためには、SaaS をはじめとする業務サービスに接続する
端末の健全性を評価する必要がある。端末の健全性は、以下のような要素で評価する。
• OS バージョン
• 所定のセキュリティツールのインストール状況
• OS やアプリケーションに対する所定の設定の実施状況
• OS やアプリケーションに対する脆弱性の保有状況
• 未対応のセキュリティインシデントの重要度
端末の健全性を可視化し、システムによる維持を強制することは、端末を制御する上で必要不可⽋である。こ
れにより、組織で利⽤される端末の健全性が保たれていることについて説明可能となる。
n データ管理規則のコンプライアンス
組織は、どこにどのようなデータを保管しており、誰がどのようにアクセスするかを制御し、それらを記録し
ているか説明できる必要がある。通常、組織は情報セキュリティポリシーのデータ資産⼀覧にてこれを規定し、
遵守するポリシーを策定する。システムによる制御がされておらず利⽤者の運⽤に依存した環境では、組織のデ
ータは端末や各種 SaaS に散在しがちであり、ポリシーの遵守状況は客観的に説明可能な状況とは⾔い難いもの
となっている。
組織は、その説明を可能とするために以下のアプローチを取ることができる。
• 組織のデータを集約するストレージとして、きめ細かなアクセス履歴やアクセス制御、および API によ
る情報の取得やデータ操作の機能を有するものを⽤いる。
• データの所在を特定の場所に集約するサービスやインテグレーションを⽤い、それ以外の場所へのデー
タ転送を制御する機構と組み合わせることで、制御可能な範囲にデータの集約を促進する。
• 端末に保存しているデータを集約し、集約したデータの検索と保全を可能とするツールを導⼊する。
n ネットワークによる制限
セキュリティ境界をエンドポイントに引き下げ、制御されたユーザー認証・端末認証を⽤いたとしても、攻撃
⾯の削減の観点でネットワークによる制限は依然として必要である。前述のとおり、組織の業務システムにおい
て、境界型ネットワークの制限によってセキュリティが保たれているとは⾔い難い状況ではあるが、多くの攻撃
を遮断していることもまた事実である。ネットワーク制限によって攻撃⾯を削減することで、セキュリティ施策
を効果的に配置することが可能となる。
ネットワーク制限には、ホスト型ファイアウォールの利⽤や、セキュリティ機構をホストするデータセンター
の IP アドレスのみを許可する設定、および接続する Wi-Fi の暗号化規格にもとづく制御などが挙げられる。
10
2-1-2 . リスク対応を考慮した業務インフラの考え⽅
ID の認証認可と端末の認証を制御し、端末の健全性の可視化・維持を続けても、情報資産を取り巻く環境と
利⽤状況、およびそれらの状態は刻々と変化する。組織における業務がネットワーク境界の外に広がりつつある
現状では、端末が接続するネットワークによってもリスクは変動する。
そのため、認証認可の条件や端末の健全性は固定的なものでなく、さまざまなリスク要因にもとづいて変化し
ていく必要がある。
本項では、リスクに応じた構成変更を⾏うための考え⽅について記載する。
n 脅威情報と脆弱性情報の利⽤
リスクは、脅威の源泉と脆弱性、組織に与える影響の掛け合わせにて算出できる。脅威の源泉とは、組織に対
する敵対者（アドバーサリ）や⾃然現象を指す。アドバーサリの戦術/技術/⼿順（TTP）や動機や意図、能⼒、
およびリソース定義することで、リスクを評価するための材料とできる。脅威の源泉に係る情報は、JPCERT コ
ーディネーションセンター（JPCERT/CC）や独⽴⾏政法⼈ 情報処理推進機構（IPA）などの団体から公開され
ることがあるが、より詳細でタイムリーな情報は、脅威インテリジェンスサービスから⼊⼿できる。
また、脆弱性の情報も各ベンダーから公開されており、特に影響が⼤きいものについては、JPCERT/CC や
IPA などの団体から公開されるものを⼊⼿できる。脆弱性の情報については、CVSS など重要度をスコア化する
フレームワークがあるが、⾃組織における利⽤状況や環境要因によってスコアが変動するため、都度優先度付け
を⾏う必要がある。何故ならば、全ての脆弱性が機関によって採番され公開されるわけではないためである。
n 脅威情報のタイムリーな活⽤
従来、収集した脅威情報への対応を組織の業務インフラに適⽤するには、業務インフラの資産管理情報や構成
管理情報との⼈⼿による突き合わせが必要であった。そして、その結果から導き出されたセキュリティ施策は、
その適⽤までに多くの⼿間と時間を要していた。また、ID 利⽤状況の観察や、接続元ネットワークの変遷やロ
グイン履歴の分析・評価が定期的に⾏われていたとしても、タイムリーなものではなかった。モダンな業務イン
フラでは、脅威情報の収集と突き合わせおよび分析をシステムで⾃動的に実施し、その結果のレポーティングや
システム制御の判断材料としてタイムリーに活⽤していくことが求められる。
n シャドーIT への対応
組織が認知していないアプリケーションのインストールや、クラウドサービスの利⽤などをシャドーIT と呼
ぶ。この状況を把握するためには、MDM の配備およびプロキシなど各種サーバーのログを定期的にチェックす
る以外に術はなく、ログから利⽤しているアプリケーションやクラウドサービスのドメイン、URL を調査する
ために多くの⼿間と時間が費やされていた。多岐に渡るアプリケーションや、各種サーバーログは、プロセス名
や FQDN、URI での記録にとどまるため、組織で許可していないものであるか否かを識別することはできなかっ
た。
11
SaaS など Web の通信を復号し、内容を評価する機構として古くから Data Loss/Leak Prevention（DLP）が
存在するが、従来のアプライアンス機器を⽤いた実装⽅式では、インターネットへの接続点を集約する必要があ
り、拡⼤を続ける業務の現場に対応することは難しくなってきている。
モダンな業務インフラでは、ネットワークのトポロジに依存することなく、利⽤しているアプリケーションや
SaaS とテナントを識別し、特に Web 通信は復号して内容を評価できることが求められる。
このように、組織における業務が、さまざまな場所やさまざまなアプリケーション、SaaS に広がっていく状
況においては、証跡やログが分散することが予想される。そのため、アプリケーションの起動状況、SaaS や遠
隔地の端末のログを集約・分析できる機構が求められる。
n 脆弱性に迅速に対応できる環境構築とその維持
システムが⽇々脆弱性のない環境を作り上げ、対処し続けることをサイバーハイジーンと呼ぶ。脆弱性情報は
⽇々更新されるため、脆弱性のない環境の構築と維持には、組織の業務インフラ環境において以下の要素が必要
となる。
• 定常的な資産情報の収集（端末・OS／アプリケーション名・バージョンなど）
• 定常的な脆弱性情報の収集（OS／アプリケーション名・影響を受けるバージョン・脆弱性の内容・重要
度・脆弱性の利⽤状況など）
• 定常的な資産情報と脆弱性情報との突き合わせによる、組織内における脆弱性の保有状況の可視化
• パッチやアップデートの配信および適⽤状況をモニタリングする機構
また、最新バージョンの OS は多くの脆弱性の対処がなされていることから、端末の OS バージョンはポリシ
ーに従って制御可能であることが望ましい。⼀定のバージョンより古い OS の端末からのサービス利⽤を制限す
ることで、脆弱性による影響を業務インフラから切り離すことができる。
n 動的ポリシーを適⽤するための環境
これまで述べたとおり、端末や接続するネットワーク、利⽤ ID の状況は刻々と変化していくため、静的な認
証認可ポリシーではその変化に対応することはできない。SaaS への認証認可を司る IAM は、接続する SaaS の
重要度に応じて、端末や接続するネットワーク、利⽤ ID の状況に基づき、認証要素を追加する動的ポリシーの
利⽤に対応している必要がある。
n リスクに応じた構成変更が可能な業務インフラ
OS やアプリケーションが保有する脆弱性は、その全てに対応することで業務アプリケーションの稼働に影響
を及ぼす可能性がある。また、脆弱性情報は⽇々更新されるため、脆弱性の内容から実際に影響を及ぼす可能性
の多寡を推測することは容易でない。
リスクは顕在化することで組織への負の影響をもたらすため、実際に利⽤されている脆弱性がリスクの⾼い脆
弱性であると⾔える。
12
そのため、組織の業務インフラでは、検出された脆弱性が実際に利⽤されているものであるかを⾃動的に識別
する機構が必要である。
また、リスクが⾼いと識別された脆弱性に対して迅速に対応するためには、ネットワーク構成に依存しないパ
ッチ配信機構が必要である。
2-1-3 . BYOD の考え⽅
BYOD の考え⽅については、別添の『BYOD ポリシー雛形』を参照すること。
2 - 2 . 基本⽅針を体現するアーキテクチャ
本節では、基本⽅針を実現するためのアーキテクチャと設計、設定ポリシー、および運⽤について記載する。
まず、アーキテクチャの中⼼となる構成を以下に⽰す。
13
本アーキテクチャの軸となる要素は以下の通りである。
• 認証と認可
• 端末制御
• エンドポイントセキュリティ
• SaaS・Web 利⽤制御
• データガバナンス
• SIEM
2-2-1 . 構成要素
各要素の構成するために採⽤した製品とその概要について以下に⽰す。
n 認証と認可
⽬的と概要
本アーキテクチャは、⾏政の事業データの取り扱いを前提とするため、従来の ID・パスワードによる認証の
みではなく、より⾼度な認証認可の仕組みが必要となる。
⼀般的な要件
ID・パスワードを⽤いた知識認証に加え、スマートフォンや FIDO2（Fast IDentity Online 2 ）対応デバイス
を⽤いた所有物認証、および指紋や顔などの⽣体認証への対応が必要である。
加えて、認証を通過した端末に対する認可について、刻々と変化する端末の状態や端末が接続するネットワー
ク、ログオンする端末 User Agent や OS バージョン、ブラウザなどの属性にもとづくログインパターンを基に
動的に認可の可否や認証要素の追加要求を⾏うなど、⾼度な判断が⾏われる必要がある。
本アーキテクチャ特有の要件
事業で扱うさまざまなクラウドサービスに対して、事業に携わる職員による継続的かつ⼤規模なメンテナンス
を⾏うことなく、ユーザーやグループのプロビジョニングが可能で、SAML や OIDC の認証プロトコルに⾮対応
のクラウドサービスに対してもシングル・サインオン（以下、SSO）を構成して、先に述べた認証認可を適⽤で
きる必要がある。
また、職員が普段利⽤する ID に特権を付与し続けることや、特権をもつ ID を共有することで意図せぬイン
シデントが発⽣する可能性がある。そのため、事業に携わる職員が利⽤する ID には特権を付与せず業務上必要
な作業時のみ⼀時的な特権を付与し、特権の利⽤を記録・管理するために単⼀の ID のみを利⽤できる環境が求
められる。
14
選定
認証認可の基盤として、これらの要件を全て満たす環境を迅速に構成できる、Microsoft Azure Active
Directory を採⽤する。
n 端末管理
⽬的と概要
端末管理とは、端末の情報を収集し、設定やアプリケーション、証明書を配信することで、組織で管理する端
末を⼀元的に管理・制御することである。端末を管理下におくことで、端末の健全性を保つだけでなく、アプリ
ケーションの配布や変更が容易となる。
⼀般的な要件
事業に携わる職員はシステム上の理由で業務遂⾏する場所を制限されるべきではない。そのため、職員の所在
や接続するネットワークに関わらず、インターネットを通じて端末に対する設定やアプリケーションを配信し、
その端末の情報を収集、および端末の挙動を制御できることが求められる。
また、収集した情報は、認証認可に関わる制御を判定する材料として、認証認可の基盤に共有されなければな
らないことから、端末制御の基盤と認証認可の基盤は統合されている必要がある。
本アーキテクチャ特有の要件
本アーキテクチャは、事業に携わる⼈的リソースが限られていることと、証明書の安全な取り扱いに対する教
育コストを低減する観点から、Windows や macOS、iOS、iPadOS、および Android に対して、デバイス認証に
⽤いる証明書の発⾏・配布・更新・失効プロセスに、⼈が介在することなく⾃動的に⾏える必要がある。
また、事業の期間が数ヶ⽉〜2 年と短期となる場合においても速やかに環境構築を⾏い、本来⾏うべき事業に
注⼒するため、証明書発⾏管理のために専⽤システムの構築を別途⾏わなくてもよい構成であることが求められ
る。
選定
端末制御の基盤として、これらの要件を全て満たす環境を迅速に構成できる、Microsoft Intune と Jamf Pro
を採⽤する。
Microsoft Intune と Jamf Pro の使い分けと関係性について、以下に⽰す。
• Microsoft Intune は、Windows 10 端末を制御するために⽤いる。
Microsoft Intune は、Azure Active Directory と統合されているため、収集した端末の属性情報を Azure
Active Directory に引き渡すことができる。
15
• Jamf Pro は、macOS と iOS、iPadOS を制御する上で秀でており、端末内のさまざまな情報にもとづい
て動的にグルーピングするのに⻑けている。これは、制御が難しい構成を配信する上で適⽤順序を適切
にコントロールすることに寄与する。また、Jamf Pro は、Microsoft Intune と連携することができ、収
集した端末の属性情報を Microsoft Intune に引き渡せる。
n エンドポイントセキュリティ
⽬的と概要
本アーキテクチャは、事業に関わる職員が接続するネットワークに関わらず安全に業務遂⾏する必要があるた
め、セキュリティ境界を端末に引き下げる観点から、端末への設定を徹底することが必要不可⽋である。
⼀般的な要件
端末へ設定を徹底することには、以下の内容が含まれる。
• ホスト型ファイアウォールを⽤いたネットワーク接続の制御
• 攻撃者が利⽤する攻撃⾯を縮⼩する OS 設定
• タイムリーな OS アップデートやパッチ適⽤対応
• 未知・既知のマルウェアへのリアルタイム対応や不審な挙動の検出と制御
• フィッシングメールをはじめとする不審メールや添付ファイルに含まれる脅威の検出と防御
また、メールに係る脅威は、アンチマルウェアや振る舞い検知以外の部分でもメール特有の攻撃⼿法（スプー
フィング、類似ドメインの利⽤、乗っ取ったエグゼクティブのメールアカウントの利⽤、Reply-to の置き換
え、不審な URL）に対して検出・評価・抑⽌できる必要がある。特に、メール本⽂や添付ファイルに記載され
た URL への接続後にやり取りされる通信の内容に対して、HTTPS 通信を復号した上での評価や検査が必要であ
る。メールに係る脅威は、端末上での挙動調査（送付された URL のクリック状況など）と密接な関係性がある
ため、統合した調査ができることも求められる。
別の観点として、端末は、侵害の可能性を避けられないものであるが、侵害の可能性のある端末を完全に利⽤
停⽌状態（ネットワークの遮断を含む）とすることは、業務継続の観点から無理が⽣じる。そのため、侵害の疑
いのある端末は、その程度に応じて、重要な情報を保有するシステムに対してのみアクセス制限をかけ、組織が
保護したい資産へのアクセスを制限できる必要がある。
本アーキテクチャ特有の要件
端末への設定の徹底は、事業の期間が数ヶ⽉〜2 年と短期となる場合においても速やかに環境構築を⾏い、本
来⾏うべき事業に注⼒することが求められる。そのため、端末への設定を徹底するための基盤の構築や維持にか
かる運⽤は、可能な限り低減する必要がある。特にエージェント更新や OS のアップデートに追従するためのメ
ンテナンス作業を要する構成は、可能な限り避ける必要がある。
16
選定
端末への設定の徹底は、上記要件を満たす端末制御の基盤である Microsoft Intune と Jamf Pro を通じて実施
する。
端末のマルウェア対策や未知の攻撃に対応するため、Endpoint Detection and Response （EDR）を導⼊す
る。
EDR は、上記要件を満たす Microsoft Defender for Endpoint を採⽤する。Microsoft Defender for Endpoint
の特徴は以下の通りである。
• Windows 10 の OS 機能の⼀部であり、Windows 10 においては Microsoft アプリケーションへの⼲渉や
OS バージョンアップに伴う影響が発⽣しないため、動作確認に係る運⽤業務を軽減できる。
• Windows 10 に対して Microsoft Intune を通じて有効化できる。
• macOS に対して Jamf Pro を⽤いて配信できる。
• 未解決のセキュリティインシデントのリスクレベルを Microsoft Intune を通じて、Azure Active
Directory に属性情報として連携できる。
端末に導⼊しているアプリケーションの収集と脆弱性情報を管理するため、先述の要件を満たす Threat ＆
Vulnerability Management（TVM）を導⼊する。
TVM の特徴は以下の通りである。
• Microsoft Defender for Endpoint が提供する機能を⽤いる。
• Windows 10 と macOS において、OS と導⼊しているアプリケーションのバージョンから脆弱性をリス
トアップする。リストアップされた脆弱性は、悪⽤されているものであるかを識別できる。
メールやファイルを通じたフィッシングやスパム、マルウェアを検出・対処する⽬的で、先述の要件を満たす
Microsoft Defender for Office 365 採⽤する。
Microsoft Defender for Office 365 は、メールの添付ファイルに対するウイルスチェック・サンドボックス機
能だけでなく、PDF や Office ファイルに含まれる URL を安全なものに置き換える機能を⽤いて、EDR と協調
したエンドポイント保護を実現できる。
端末が接続する不審な URL の評価や、Web サービスと端末間でやり取りされる通信の内容に脆弱性を突く内
容が含まれているかを検出・通信の抑⽌を⾏う⽬的として、上記条件を満たす Netskope と同製品の Threat
Protection 機能を採⽤する。
n SaaS・Web 利⽤制御
⽬的と概要
本アーキテクチャは、事業に関わる職員が利⽤するクラウドサービスを可視化し、認可された安全性の⾼いク
ラウドサービスのみ利⽤することを推進していく必要がある。職員が利⽤するクラウドサービスは、データの取
扱状況やアクセスコントロール、監査性などが貧弱なものであってはならない。
17
⼀般的な要件
クラウドサービスの利⽤を可視化・制御する機構は、多岐にわたる SaaS を識別し、さまざまな観点での分析
結果に基づいた格付けをレポートし、その格付けに基づいた利⽤制御機能が必要である。
クラウドサービスのレポートとして必要な観点は、以下のものが挙げられる。
• 第三者認証の取得状況
• データの取り扱い
• アクセスコントロール
• 監査性
• ディザスタリカバリと事業継続
• 法律とプライバシー
• 脆弱性と侵害の実績
また、認可されたクラウドサービスであっても、組織や事業が契約したテナントと個⼈が契約したテナントを
識別し利⽤を制御することで、データの持ち出しを抑⽌できる必要がある。そのため、SaaS を利⽤制御する機
構は、HTTPS 通信を復号し、接続する SaaS のテナントを識別できる必要がある。
本アーキテクチャ特有の要件
事業に携わる職員は、利⽤する端末からさまざまな Web サイトにアクセスすることが想定され、安全に業務
を遂⾏するためには⼀般的なカテゴリフィルタリングや脅威情報にもとづくフィルタリングの他に、動的なカテ
ゴリフィルタリングが必要となる。動的なカテゴリフィルタリングの対象には、作成されたばかりのドメインや
管理者が変更されたばかりのドメインが分類される。
事業に携わる職員はさまざまな場所から業務遂⾏するため、ネットワークトポロジに依存せずにこれらを制御
できることが求められる。
選定
SaaS・Web の利⽤制御機構として、上記要件を満たす Netskope を採⽤する。
n データガバナンス
18
⽬的と概要
本アーキテクチャでは、事業で取り扱われるデータ管理の透明性（アクセス状況の可視化、アクセスと公開範
囲の制御、データの所在の把握、流通状況の可視化と制御、データ暗号化に係る⾃組織で⽤意する鍵の利⽤と管
理）が必要となる。
データガバナンスの対象をストレージ・通信データ・ローカルデータ・メールの 4 つに分け、それぞれ順に
解説する。
⼀般的な要件
組織内のデータを集約・管理するストレージは、きめ細やかなアクセス権限と公開範囲の制御を、利⽤者に意
識させないことが要求される。例えば、不特定多数の利⽤者からの情報収集は、内部に対する公開範囲を絞った
フォルダに格納する構成を容易に⾏える必要がある。そのため、当該ストレージは、設計・管理された権限を強
⼒にフォルダツリーに伝播できる必要がある。
また、当該ストレージは、データの利⽤状況と管理に対する説明責任を果たす⽬的で、データのアクセス状況
（閲覧、ダウンロード、更新、削除）と管理操作の記録が詳細に取得し、レポートできることが求められる。
本アーキテクチャ特有の要件
事業に携わる職員は、本来の事業で成すべき事柄に時間を費やすべきであり、特定の職員がストレージの維持
や管理に時間を割かれることは望ましくない。そのため、ストレージ管理作業のうち、特に多くなることが予想
される内部・外部とのコラボレータの管理を部⾨や、事業ごとの管理者に委任できることが望ましい。
また、当該ストレージは、⾏政⽂書を保管することから、インデックスを含む内容をストレージの運営事業者
からも閲覧できないよう、事業側で⽤意した暗号鍵を⽤いてストレージ上のデータを暗号化する必要がある。⼀
⽅で、事業側で⽤意した暗号鍵を⽤いた暗号化は、ストレージが提供する検索機能を阻害してしまう。そのた
め、ファイルやフォルダ、フォルダツリーに対して、検索性を補完するメタデータを付与できることが求められ
る。
別の観点として、事業に係る職員と外部事業者がデータ共有を⾏う上で、データをダウンロードして編集する
運⽤は、事業で取り扱うデータが制御可能な領域外に分散していくことを意味する。そのため、当該ストレージ
は、さまざまな形式のデータのプレビューすることができ、特に編集する機会の多いオフィスファイル
（Microsoft 形式や Google 形式）について、オンラインで編集できることが求められる。また、データ共有す
る相⼿にレビューを求める際に、編集やダウンロードを許可することなく、ストレージ上のデータに対してコメ
ントを付与する形でのコラボレーションが求められる。
選定
組織内のデータを集約・管理するストレージとして、上記要件を満たす Box を採⽤する。
19
n データガバナンス（通信データ）
⽬的と概要
データの機密性が 3 以上に類するものである場合、データの流通を管理し、制御できる必要がある。本アー
キテクチャにおける通信データを対象としたデータガバナンスについて解説する。
⼀般的な要件
事業に係るデータが流通する場として、先に述べた SaaS・Web・ストレージの他にメールとチャットが挙げ
られる。
メールとチャットは外部事業者とデータやり取りする場となるため、データの流通を管理する機構は、メール
とチャットシステムに対して API を⽤いたファイルの内容の検査が必要である。
本アーキテクチャ特有の要件
事業で取り扱うデータが機密性 3 以上に類するものである場合、データの流通を管理する機構は、その流通
経路を問わず検出・抑⽌できる必要がある。
機密性ラベルは、⽇本語で⽂書上に表記されるため、データの流通を管理する機構は、分類ラベルを別途付与
することなく SaaS や Web サービスを流通する HTTPS 通信を復号し、通信データからファイルの内容を⽇本
語で識別できる必要がある。
選定
データの流通を管理する機構として、上記要件を満たす Netskope を採⽤する。
n データガバナンス（ローカルデータ）
⽬的と概要
端末の利⽤はオフラインで利⽤されることも想定される。通信可否に関わらず、端末のデータは制御下である
必要がある。本アーキテクチャにおけるローカルデータを対象としたデータガバナンスについて解説する。
⼀般的な要件
本アーキテクチャは、事業に係るデータが保存される場として、端末のローカルファイルシステムが含まれ
る。そのため、組織内の端末に保存されているデータを⼀元的に保全・追跡可能とすることで、内部犯による不
正⾏為の記録や情報の持ち出しや改ざん、削除に対する否認を防⽌や漏えい情報の経路特定、および影響範囲を
特定できる必要がある。
20
本アーキテクチャ特有の要件
不正⾏為の記録はメールにも含まれるため、職員が業務で利⽤する全ての端末内のデータとメールを保全し、
職員毎に管理できる必要がある。端末ローカルのデータ漏えい防⽌を⽬的とした端末の所在追跡やインターネッ
トと通信ができないオフライン状況でのリモートワイプを実現する必要がある。
選定
端末のローカルファイルシステム上のデータとメールのガバナンスを実現する機構として、上記要件を満たす
Druva inSync を採⽤する。
n データガバナンス（メール）
⽬的と概要
メールの誤送信時に添付ファイルが拡散した場合、管理や制御ができない点を解決する。本アーキテクチャに
おけるメールを対象としたデータガバナンスについて解説する。
⼀般的な要件
本アーキテクチャでは、組織内外とやり取りするメールの添付ファイルについて、合理的かつ根本的な誤送信
対策を⾏う⽬的で、ファイル⾃体を相⼿先に送付することなくやり取りすることを実現でき、誤送信が発⽣した
際にはそのファイルへのアクセス権を取り消す必要がある。そのため、誤送信対策機構は、メールの添付ファイ
ルをメールから分離・ストレージに格納した上で、メール本⽂にストレージに格納したファイルへの共有リンク
に差し替えることが求められる。また、ストレージに格納したファイルには、受信者のみに認証を経てアクセス
可能とする等の適切なアクセスコントロールを設定可能とする必要がある。
⼀⽅で、共有リンクを受け取った組織が、ストレージへの接続が許可されていない場合を考慮して、誤送信対
策機構は特定のメールドメインに対して送受信する、メールの添付ファイル分離処理をバイパスできる必要があ
る。
本アーキテクチャ特有の要件
別の観点として、S/MIME をはじめとするメール暗号化技術と添付ファイル分離が⼲渉することのないよう
にすることも忘れてはならない。そのため、誤送信対策機構は、メール作成の時点でストレージ上のファイルを
メールに共有リンクという形で直接添付することで、暗号化されたメールにはファイルが添付しない運⽤が⾏え
る必要がある。この操作は運⽤利便性を考慮して、容易であることが求められる。
21
選定
誤送信対策機構として、上記要件を満たす mxHero を採⽤する。
n SIEM
⽬的と概要
本アーキテクチャは、Azure Active Directory や Office 365、Exchange Online、Microsoft Defender for
Endpoint など Microsoft 製品を多く採⽤している。SIEM は、本来分析・調査したい事柄からログの出⼒や正規
化、収集を設計し、分析ロジックと可視化の実装を要する。
⼀般的な要件
事業に係る職員や事業者は、事業で達成する⽬標に注⼒するべきであり、SIEM のパフォーマンスチューニン
グや冗⻑構成、およびシステムの維持管理に費やす労⼒は最⼩限に抑える必要がある。このことから SIEM 機構
はクラウドで実装され、Microsoft 製品を中⼼としたクラウドサービスに対するコネクタを豊富に取り揃えてお
り、分析や可視化のテンプレートが予めセキュリティ運⽤の観点で機能するよう取り揃えられている必要があ
る。
本アーキテクチャ特有の要件
数ヶ⽉〜2 年程度の短い事業が多いことから、SIEM 機構の構築や実装にかかる期間は極⼒短くできることが
求められる。
また、事業の規模は⼤⼩さまざまであり、予算が抑えられている⼩規模な事業であっても SIEM を導⼊できる
必要がある。そのため、SIEM の課⾦体系は、データの流⼊量と保存期間をベースに従量課⾦に対応し、イニシ
ャル・ランニングコストを抑えることが求められる。
選定
SIEM として、上記条件を満たす Microsoft Azure Sentinel を採⽤する。
2-2-2 . 各アーキテクチャ要素における設計と運⽤
本項では、先に述べた⼀般的な課題や要件および経済産業省特有の課題に対して、各アーキテクチャ要素をど
のような設計と運⽤で解決するかを記載する。
n 認証と認可
22
本アーキテクチャの認証認可における設計と運⽤について以下に⽰す。
ID の管理
ID は、Azure Active Directory に登録したユーザーとグループをマスターとし、利⽤するクラウドサービスに
対して、SAML、SCIM、OIDC、または API を⽤いてユーザーとグループをプロビジョニングする構成とする。
グループは、クラウドサービス側で認可設定を⾏う際の設定単位として⽤いることができる。そのため、ID 管
理者は、各クラウドサービスの認証と認可に係るグループメンバーシップの管理を Azure Active Directory 上で
のメンテナンスをもって完結する構成とした。
23
認証の条件
認証は、各プラットフォームにおいて、多要素認証を構成した。
Windows 10 環境
Windows Hello for Business を構成し、PIN または⽣体認証を⽤いたパスワードレス認証を構成する。加え
て、Azure Active Directory 条件付きアクセスを⽤いて、Microsoft Intune の登録状況と Microsoft Defender for
Endpoint での未解決リスクの残留状況、および送信元 IP アドレス（Netskope のデータセンターであること）
を条件とすることで、事業の情報資産を取り扱うクラウドサービスにアクセスするセキュリティ基準を満たして
いる端末からの認証であるということを検証する。
Azure Active Directory 条件付きアクセスは、Windows 10 環境においてはブラウザとして Microsoft Edge、
Internet Explorer、Google Chrome にて動作する。そのため、Windows10 環境においては、これらのブラウザ
を標準ブラウザとして利⽤する。
macOS 環境
Jamf Connect を構成し、Web Auth 認証を通じて Microsoft Authenticator を⽤いた多要素認証を構成する。
加えて、Azure Active Directory 条件付きアクセスを⽤いて、Jamf Pro の登録状況と Microsoft Defender for
Endpoint での未解決リスクの残留状況、および送信元 IP アドレス（Netskope のデータセンターであること）
を条件とすることで、事業の情報資産を取り扱うクラウドサービスにアクセスするセキュリティ基準を満たして
いる端末からの認証であるということを検証する。
Azure Active Directory 条件付きアクセスは、macOS 環境においてはブラウザとして Safari、Google
Chrome にて動作する。そのため、macOS 環境においては、これらのブラウザを標準ブラウザとして利⽤す
る。iOS、iPadOS、Android 環境では、適切な強度の PIN を構成するよう MDM を通じて設定を配信する。PIN
の強度設定は、『NIST SP800-63B』に準じて設定する。
認可の条件
認可は、Azure Active Directory Identity Protection Premium P2 を⽤いて、ログインする端末が接続するネ
ットワークや UserAgent、ブラウザバージョンなどの端末情報（プロパティ）、およびログインパターンを鑑み
て動的に認可を判定するサインインポリシーとユーザーリスクポリシーを構成する。
SSO の構成
IdP である Azure Active Directory を⽤いて組織が業務で利⽤する SaaS に対して、SSO を構成する。 SSO
を構成する際に IdP から SaaS に対してユーザー名として引き渡す情報の⽅針について、以下にまとめる。
• SaaS がメールアドレスを要求する場合、原則として、IdP は UPN ではなくメールアドレスを渡すよう
に構成する。
24
• ユーザー名（メールアドレス）がユニークであることを SaaS が要求する場合がある。管理する担当者
のメールアドレスが、すでに別のテナントを管理しているケースにおいて、ユーザー登録できない可能
性がある。このケースは、特に管理作業を⾏うユーザーで起こり得る。その場合は、別のメールアドレ
スを発⾏し、Azure Active Directory に外部ユーザーとして登録する⽅針とする。発⾏されたメールアド
レスが、本⼈のものであるかを検証したいが、検証が難しい場合は、組織が払い出したメールアドレス
を利⽤する⽅針とする。
外部ベンダーによる環境のメンテナンスを委託する場合
SaaS の運⽤を外部ベンダーが⾏う場合、SaaS に SSO するため IdP にユーザー登録を⾏う必要がある。SSO
を構成する⽅針として、SaaS がメールアドレスを要求する場合、UPN ではなくメールアドレスを渡すように構
成する。
SSO ⾮対応の SaaS への対応
SAML や OIDC といった SSO プロトコルに対応しない SaaS に対しては、Azure Active Directory の
Password Based SSO を⽤いた管理を⾏う構成とする。 Password Based SSO は、ブラウザ拡張を⽤いて ID
とパスワードを代理⼊⼒する機能である。利⽤者と管理者は、Password Based SSO において、ID とパスワー
ドをブラウザ拡張に登録する必要がある。管理者⾃⾝が ID とパスワードを登録することで、利⽤者にパスワー
ドを知られる事なくパスワードを登録できる。
本事業では、SSO ⾮対応の SaaS を利⽤しなかったことから、Password Based SSO を⽤いた検証は⾏わな
かった。
SaaS 利⽤者の認証と認可のメンテナンス
SaaS 利⽤者への認証認可は、IdP におけるグループのメンバーシップにもとづいて制御する。グループメン
バーシップのメンテナンスは、Azure Active Directory Identity Protection Premium P2 のアクセスレビュー機
能を⽤いて、各グループの複数の代表者によって⾏う。アクセスレビュー機能は、直近 30 ⽇の Azure Active
Directory への認証履歴にもとづいて、グループメンバーシップの承諾・拒否の推奨を提⽰する。各グループの
代表者は、指定された期間内にレビューを完了することで、SaaS に認証認可させる利⽤者のメンテナンスを⾏
える。
この運⽤により、IdP 管理を⾏う担当者にグループメンバーシップのメンテナンス業務が集中することなく、
各グループの責任者に委任できる。
共有アカウントの取り扱い
SaaS 利⽤者には個⼈を識別可能な⼀意の ID を発⾏し、共有アカウントを発⾏しない。
25
システムユーザーの管理
SaaS システムを管理・運⽤するために、⼈に紐付かないユーザーアカウント作成が必要な場合がある。ま
た、Azure Active Directory 条件付きアクセスのような強い認証制御機構設定時の事故に対応する⽬的で、⼈に
紐付かない緊急⽤ユーザーを作成する必要がある。このような場合、これらのユーザーアカウントには、ID/パ
スワードのみの認証を許可するよう構成し、その利⽤の際にアラート通知されるよう構成する。本実装について
は、「SIEM」の節を参照すること。
これらのユーザーアカウントを利⽤する際は、申請と承認を要する運⽤とする。組織の管理者はアラート通知
の際に申請・承認記録を確認する運⽤とする。
システムユーザーアカウントのパスワードは、SSO を構成可能なパスワードマネージャを⽤いて管理するこ
とが望ましいが、本事業では期間と予算の関係上、実装・検証するに⾄ってはいない。
認証認可に係る検証結果
SaaS 利⽤者に対して、正当性や本⼈性を適切に確認できる認証認可の基盤として動作することが確認でき
た。
n 端末認証
本アーキテクチャの端末認証における設計と運⽤について以下に⽰す。
26
証明書の発⾏管理プロセス
端末認証に⽤いる証明書は、Microsoft Intune、Jamf Pro にて発⾏される証明書を⽤いる。この証明書は、
Microsoft Intune、Jamf Pro にて⾃動的に発⾏され、24 時間の有効期限が設定されている。配布・更新プロセ
スも Microsoft Intune、Jamf Pro にて⾃動的に⾏われるため、証明書の発⾏・配布・保管・更新・失効プロセ
スに⼈が介在しない構成を実現した。そのため、証明書に係る運⽤は発⽣しない構成となった。
端末認証に係る検証結果
⼈的リソースの制約を鑑みた⾃動化の実装がなされており、管理者の作業負担を低減できると評価した。
n 端末の健全性
本アーキテクチャの端末の健全性における設計と運⽤について以下に⽰す。
端末への設定の徹底と健全性の評価
組織のセキュリティ管理者は、Microsoft Defender for Endpoint の Threat & Vulnerability Management
（TVM）機能を⽤いて、収集されたインベントリ情報にもとづいて可視化された、利⽤中の OS やアプリケーシ
ョンに存在する脆弱性と、世の中で実際に利⽤されている脆弱性にもとづいてパッチ適⽤⽅針や優先度決定をす
る運⽤を⾏う。
Windows 10 環境への設定の徹底は、攻撃によく⽤いられる機能やアプローチを阻害する、攻撃⾯の縮⼩ルー
ルをブロックモードで構成することを基本とする。
また、TVM 機能にてレポートされた OS の推奨設定にもとづいて、Microsoft Intune や Jamf Pro を⽤いて追
加の設定を配布する。
27
TVM 機能は、対応状況のスコアリングを提供するが、スコアは⽇々変動するため完全な対応を⽬指すことは
せず、世の中で実際に悪⽤されている脆弱性を優先的に対応していく⽅針で運⽤を⾏う。
セキュリティリスクにもとづくアクセス制御の強制
IdP は、Microsoft Defender for Endpoint で可視化された未対応のセキュリティリスクの残留状況にもとづい
て、アクセス制御するよう構成する。セキュリティリスクは、マルウェアや不審なプロセスの検出状況に応じて
レベル付けがなされる。検出されたセキュリティリスクは、Microsoft Defender for Endpoint にて⾃動的・半
⾃動的に対応されるが、運⽤状況によっては軽微な検出について⼀定期間残留する可能性が考えられる。そのた
め、重要なデータを扱う SaaS 以外の認証については、軽微なセキュリティリスクが残留した状態での認証を許
可するよう構成する。
端末の健全性に係る検証結果
端末の健全性に関し、状況の可視化だけでなくセキュリティリスクの残留状況に基づいたアクセス制御が可能
なことを確認できた。
n データガバナンス
本アーキテクチャのデータガバナンスにおける設計と運⽤について以下に⽰す。
機密情報の流通の把握と制御
データが流通する経路や保存される箇所は以下のように定義される。
28
データが流通し得る経路
• インターネット（Wi-Fi、テザリング経由）
• メール（Exchange Online）
• 周辺機器接続ケーブル
データの流通先となり得る場所
• 組織で認可する SaaS、Web
○ Box
○ Slack
○ Backlog
○ GitHub
• 上記以外の SaaS、Web
• USB ストレージ・外部メディア
• PC・スマートフォン・タブレット
データは、PC・スマートフォン・タブレットを起点に Web やメール、周辺機器へ流通することから、これら
のデバイスを起点とした流通先へのデータ保存を制御する⽅式として以下を実装する。
PC
データを加⼯編集する業務が中⼼となるため、データ保存⾃体の制限は⾏わず、USB デバイスに対する利⽤
制限を Microsoft Intune と Jamf Pro で配信する。また、Netskope Agent を導⼊し、機密性 1〜3 を識別する⽇
本語⽂字列を条件として、SaaS や Web へのファイルアップロードに対して制限や警告の記録を⾏うよう構成
する。Netskope は、接続する SaaS や Web を可視化しつつ、テナント単位で認可 SaaS を登録し、認可外テナ
ントや SaaS へのデータアップロードを制限するよう構成する。
スマートフォン・タブレット
スマートフォン・タブレットは、BYOD 利⽤が前提となっているため、端末初期化を伴う管理モードを⽤い
たダウンロード制御はできない。また、スマートフォン・タブレットに対する Netskope の導⼊は、私的な
Web や SaaS 利⽤を必要以上に監査してしまうおそれがある。そのため、スマートフォン・タブレットで⾏う
業務は、アプリからのダウンロードが制限可能な MAM アプリケーションでのみ⾏うよう事業主体と調整を⾏っ
た。スマートフォン・タブレットから MAM に対応していない SaaS の認証は、IdP で制限するように構成す
る。MAM アプリケーションは、Microsoft Intune と Jamf Pro を⽤いて配信するよう構成する。
上記実装から、Netskope が導⼊されている端末とスマートフォン・タブレットのみが制御範囲となってい
る。⼀⽅で最も多くの情報が流通・集約される Box や Slack、Exchange Online の利⽤者は必ずしも組織内の職
員に限らない。そのため Netskope の API Introspection 機能を⽤いて、当該クラウドサービス上を流通するデ
ータを利⽤者の区別なく監査するよう実装する。
29
また、PC にデータを保有する以上、端末の紛失やウイルス感染による影響範囲を特定できる必要がある。そ
のため、Druva inSync を⽤いて PC 上のユーザー領域をバックアップするよう構成する。これにより、PC 内に
保存されているユーザーデータに対して利⽤者はデータ消失のおそれがなくなり、管理者による影響範囲特定が
可能となる。
クラウドストレージに格納するデータのアクセスコントロール
データ格納先となる Box は、アクセス権限をウォーターフォール型で継承するため、データのアクセスコン
トロールを管理者側で制御する必要がある。そのため、トップレベルのフォルダ作成・管理を管理者でのみ⾏え
るよう構成する。本事業向けに構成したトップレベルフォルダとその配下のフォルダについて、以下に⽰す。
省内共有
このフォルダでは、外部共有を禁⽌し、共有リンクの公開範囲はフォルダに設定されているユーザーに限るよ
う構成した。配下に部⾨フォルダとプロジェクトフォルダを⽤意し、これらのフォルダは、申請にもとづいて
Box 管理者が作成する。部⾨フォルダには部⾨グループと部⾨管理者グループをアクセス許可グループとして登
録している。部⾨管理者グループにはコラボレータの設定権限を付与することで、部⾨フォルダ配下の管理を部
⾨管理者に委任する構成とした。プロジェクトフォルダも同様の設計⽅針で構成している。
省外共有
このフォルダでは、外部共有を許可し、共有リンクの公開範囲はフォルダに設定されているユーザーに限るよ
う構成した。配下に外部共有先会社ごとのフォルダとプロジェクトフォルダを⽤意し、これらのフォルダは、申
請にもとづいて Box 管理者が作成する。各フォルダには省内関係者グループと省内関係者管理グループをアク
セス許可グループとして登録している。省内関係者管理グループにコラボレーターの設定権限を付与すること
で、外部共有先のコラボレーター登録作業を省内関係者管理グループメンバーに委任する構成とした。なお外部
共有先のコラボレーターの有効期限を予め設定しておくことで、棚卸しの⼿間を省く構成としている。
30
個⼈⽤
このフォルダでは、外部共有を禁⽌し、共有リンクの公開範囲はフォルダに設定されているユーザーに限るよ
う構成した。配下に個⼈を識別できる名称のフォルダを⽤意し、これらのフォルダは、申請にもとづいて Box
管理者が作成する。各フォルダには個⼈ユーザーをアクセス許可ユーザーとして登録している。
⼀般公開⽤
このフォルダでは外部共有を許可し、共有リンクの公開範囲は、利⽤者によって URL を知る者全員のアクセ
スが可能である設定をできるよう構成した。
配下にパンフレットや配布資料を配置するフォルダを⽤意し、これらのフォルダは、申請にもとづいて Box
管理者が作成する。各フォルダには、省内関係者グループをアクセス許可グループとして登録している。
情報公開に慎重を期す場合は、Box Relay を⽤いたワークフローを経てレビューされたファイルが本フォルダ
に配置される⽅式は、検証期間の制約から本構成としている。
添付ファイル格納⽤
このフォルダでは、外部共有を禁⽌し、共有リンクの公開範囲はフォルダに設定されているユーザーに限るよ
う構成した。配下に、メール送信者や件名、送受信⽇時を識別可能なフォルダが、mxHero によって⾃動的に作
成されるよう構成している。なお本フォルダを直接編集・管理できるユーザーは、管理者に限定している。
これらのアクセスコントロールは、グループメンバーシップにもとづいて制御している。グループメンバーシ
ップは、IdP である Azure Active Directory 上のグループメンバーシップを反映するよう構成することで、メン
テナンス箇所を⼀箇所に集約している。
31
クラウド事業者に対するデータのアクセスコントロール
クラウド事業者によるデータ読み取りを懸念する場合、利⽤者が⽣成した暗号鍵を⽤いたデータ暗号化
（BYOK）を⾏うことで対応できる。本事業では、⾏政データをクラウド上で扱うことを前提とし、BYOK に対
応している Box と Slack に対して、これを構成する。
また Box が提供する検索機能は、ファイルの内容をインデックスに登録する必要があることから、本⽬的を
鑑みてインデックス機能を無効にするよう構成する。⼀⽅で Box における検索性を補完するため、検索に役⽴
つ属性を登録したメタデータをフォルダ・ファイルに付与できるよう構成する。特にフォルダに対して配下のフ
ァイルやフォルダに指定したメタデータを再帰的に付与する構成としている。
なお Druva inSync は BYOK に対応しているが、侵害時の影響調査や内部犯の調査で利⽤する Enterprise
Search 機能や e-Discovery 機能が利⽤できなくなることから、本事業では BYOK の適⽤を⾒送っている。
暗号鍵の管理
BYOK に⽤いる⼤元となる暗号鍵は、最終的にデータ復号に利⽤できることから厳重に管理する必要がある。
また、当該の暗号鍵を利⽤者が参照する頻度は極めて低いものである。⼀⽅本事業において、当該の暗号鍵は組
織の管理者がアクセス可能な場所に保管することが求められる。以上の条件を鑑みて、当該の暗号鍵は紙媒体と
して⾦庫で保管することが⼀定の合理性があるものと考えられる。
⾦庫の利⽤により、設置場所・コスト・省内に秘密情報が集中する状況が懸念される。そのためこれら懸念を
鑑みて、当該の暗号鍵は銀⾏の貸⾦庫や組織内の⾦庫にすることが妥当であるという結論に達した。なお本運⽤
は、期間的な問題から実施・検証には⾄っていない。
32
バックアップデータのアクセスコントロール
データ持ち出し経路の⼀つとして、バックアップデータへのアクセスがあることを忘れてはならない。本アー
キテクチャでは、PC 上のユーザーデータは Druva inSync を⽤いてバックアップしている。そのためバックア
ップデータにアクセスできる環境は、組織のセキュリティ構成が配信されており、制御されている PC に限定す
る必要がある。
ユーザーは、ユーザー向け Web コンソールと inSync Agent 画⾯からバックアップデータにアクセスでき
る。そのためまず、Druva inSync のユーザー向け Web コンソールからのバックアップデータリストアやダウン
ロードを禁⽌し、inSync Agent からのアクセスに限定するよう構成する。また、inSync Agent の認証を IdP で
ある Azure Active Directory を⽤いて SSO するよう構成し、その認証の条件として Microsoft Intune の登録と
Netskope が稼働していること、および未対応のセキュリティリスクが残留していないことを Azure Active
Directory 条件付きアクセスを⽤いて構成する。
⼀⽅で、Druva inSync で取得したバックアップデータのリストアやダウンロード操作は、定期レポートとし
て管理者に配信するよう構成することで、管理者によるバックアップデータへのアクセスについても制御できる
ようにした。
メールによる情報漏えいへの対応
外部とのファイルを⽤いたコラボレーションの基盤として、Box の外部共有フォルダを⽤意しているが、依然
としてコミュニケーションの中⼼は当⾯の間メールとなることが予想される。また、メールにファイルを添付す
る操作に慣れている職員は、Box に格納したファイルへの URL や共有リンクの利⽤を即座に受け⼊れ対応する
とは考えにくい。そのため、mxHero を⽤いて Exchange Online を経由する送受信メールに対して、添付ファイ
ルを Box へ格納し、Box に格納したファイルへの URL に置き換えるよう構成した。 また、Box に格納したファ
イルへのアクセス権は、メール受信者のみ閲覧可能となるよう構成している。メール受信者は、Box アカウント
やライセンスを保有している必要はなく、⾃⾝のメールアドレスをユーザーID とする、無料の独⽴アカウント
を登録することで利⽤可能となるよう構成した。なお独⽴アカウントのパスワードは、強固な条件のものを強制
するよう構成している。本構成により、添付ファイル付きメールを誤送信した場合であっても、管理者が Box
に格納したファイルの共有設定を解除することで、情報漏えいの封じ込めを⾏える。また、管理者が Box に格
納したファイルの共有設定を解除する以前のアクセス状況は、Box のアクセス記録にて、いつ・どのユーザーが
閲覧・ダウンロードしたかを確認できる。
33
添付ファイル分離と S/MIME への対応
本事業では、メール送信時における S/MIME の利⽤は要件としては挙がらなかったが、mxHero を利⽤した
環境での S/MIME 利⽤について⾔及する。mxHero は、S/MIME で署名・暗号化されたメールの添付ファイル
について、添付ファイルを分離する操作は⾏わない。そのため、メール送信前に添付ファイルを外部共有フォル
ダに格納し、ファイルの Box URL や共有リンクをメールに記載する必要がある。この操作を簡略化するため
に、mxHero for Outlook などのプラグインを利⽤できる。なお本事業では、検証期間の問題から mxHero for
Outlook の利⽤検証は⾏わないこととした。
データガバナンスに係る検証結果
複数のクラウドサービスの組み合わせにより、データがどこにどのように保管されており、誰がどのようにア
クセスしているかを記録し、客観的に説明可能な状態が維持できることを確認した。
n ネットワークによる制限
本アーキテクチャのネットワークによる制限における設計と運⽤について以下に⽰す。
34
地理的に分散している業務環境におけるネットワーク制御
ネットワーク制御は、Microsoft Intune、Jamf Pro を⽤いて、OS のファイアウォール機能にて全ての受信を
拒否する設定を構成する。IoC（Indicator of Compromise）情報にもとづく送信を制御する必要が⽣じた場合
は、Microsoft Intune、Jamf Pro を⽤いて、OS のファイアウォール機能に送信先を指定しての拒否設定を⾏え
るよう構成する。IoC が FQDN で提供された場合を考慮して、Netskope を⽤いて送信先を制御する構成として
いる。
脆弱な暗号化規格への対応
Wi-Fi の暗号化規格が古いなど、接続するネットワークが脆弱である場合、通信内容を傍受される可能性があ
る。Windows 10（1903）以降では、OS の機能として暗号化規格が WEP である Wi-Fi への接続に警告を表⽰
できるため、これを⽤いて利⽤者に注意を促す⽅針とした。macOS については、Jamf Pro で取得した情報にも
とづいて、警告を表⽰するスクリプトを配信することで、同様の挙動を実現する実装を⾏った。
ネットワーク制限に係る検証結果
脆弱なネットワークへの接続リスク対策として、ネットワーク制御や制限が可能であることを確認できた。
n BYOD
本アーキテクチャの BYOD における設計と運⽤について以下に⽰す。
35
BYOD 端末におけるプライベート領域の侵⾷に対する配慮
BYOD 端末のプライベート領域への侵⾷を可能な限り配慮する⽬的で、各プラットフォームにおいて、以下
の構成を実装する。
Windows10 環境
端末は、Azure Active Directory Join を⽤いて組織の MDM で管理し、ユーザープロファイルを別途作成する
よう構成する。組織で制御する端末の設定は、ユーザープロファイル上に構成されるため、個⼈利⽤のプロファ
イルに対しての監査は可能な限り⾏わないよう配慮している。また Netskope をマルチユーザーモードで配信す
ることで、個⼈利⽤のプロファイルにおいて、Web トラフィックを監査しないよう構成している。
macOS 環境
端末は、Jamf Connect を⽤いて組織の MDM に接続し、ユーザープロファイルを別途作成するよう構成し
た。組織で制御する端末の設定は、ユーザープロファイル上に構成されるため、個⼈利⽤のプロファイルに対し
ての監査は可能な限り⾏わないよう配慮している。また Netskope をマルチユーザーモードで配信することで、
個⼈利⽤のプロファイルにおいて、Web トラフィックを監査しないよう構成できる。
本事業では、期間的な問題から Netskope をシングルユーザーモードで配信している。実際に BYOD 端末を
⽤いて業務する際は、Netskope をマルチユーザーモードで配信するよう構成されたい。
iOS、iPadOS
端末は、Jamf Pro を⽤いて組織の MDM で管理し、端末ローカルや個⼈所有のアプリケーションに組織のデ
ータのコピーやダウンロードを制御する MAM アプリケーションや、同様の制御機能を有するアプリケーション
を配布する。本事業において、組織で利⽤する iOS、iPadOS アプリケーションを以下に⽰す。
MAM アプリケーション
• Box for EMM
• Skype for Business
• Microsoft Excel
• Microsoft Outlook
• Microsoft PowerPoint
• Microsoft Word
• Microsoft Office
• Microsoft OneNote
• Microsoft SharePoint
• Microsoft OneDrive
• Microsoft Teams
• Microsoft To-Do
36
MAM アプリケーションと同等の制御を可能とするアプリケーション
• Slack for EMM
本事業では、検証期間の問題から、Jamf Pro を⽤いたユーザープロファイルの分離に係る検証は⾏っていな
い。事業で取り扱うデータが MAM アプリケーション内で完結しない場合を考慮して、Jamf Pro を⽤いたユー
ザープロファイルの分離を検証する余地は⼗分にある。
Android 環境
端末は、Microsoft Intune を⽤いて組織の MDM で管理し、端末ローカルや個⼈所有のアプリケーションに組
織のデータのコピーやダウンロードを制御する MAM アプリケーションや、同様の制御機能を有するアプリケー
ションを配布する。本事業において、組織で利⽤する Android アプリケーションを以下に⽰す。
MAM アプリケーション
• Box
• Microsoft Excel
• Skype for Business
• Microsoft Office
• Microsoft Office [HL]
• Microsoft Office [ROW]
• Microsoft OneNote
• Microsoft Outlook
• Microsoft PowerPoint
• Microsoft Word
• Microsoft SharePoint
• Microsoft OneDrive
• Microsoft Teams
• Microsoft To-Do
MAM アプリケーションと同等の制御を可能とするアプリケーション
• Slack for EMM
37
本事業では、iOS、iPadOS と同じ制御レベルとする⽬的で、仕事⽤プロファイルを⽤いた検証は⾏っていな
い。iOS、iPadOS の Jamf Pro を⽤いたユーザープロファイル分離の検証結果次第では、仕事⽤プロファイルを
⽤いた構成を採⽤する余地は⼗分にある。
BYOD で利⽤する端末
BYOD で利⽤する端末は、『BYOD ポリシー雛形』を参照すること
BYOD 端末で⾏える業務の規定
本事業では、BYOD 端末で⾏える業務は、機密性 3 に該当しないデータを取り扱う業務としている。
Netskope の DLP 機能を⽤いて、SaaS や Web に流通するデータを監査し、機密性 3 に該当するデータを識別
し、その流通をブロックするよう構成する。また機密性 2 に該当するデータについては、Netskope 側でその流
通を検出し、記録するよう構成する。
BYOD に係る検証結果
BYOD 端末のプライベート領域への侵⾷を可能な限り配慮しながら、機密データへのアクセスを検知・制限
する⽅法について確認ができた。
n SIEM
38
本アーキテクチャにおける、SIEM の設計と運⽤について以下に⽰す。
データソースの繋ぎこみ
インシデント間の関連性の可視化を実現するために、以下のサービスから Azure Sentinel にログやセキュリ
ティイベントを集約し、相関分析をできるよう構成した。これらのデータソースから Azure Sentinel への繋ぎ
込みは、Azure Sentinel が標準で備えているコネクタを⽤いて実装している。
Azure
• Azure Active Directory 認証ログ
• アクティビティログ（サブスクリプションレベル）
• Azure Identity Protection ログ
Microsoft Defender for Endpoint
• インシデント情報
• EDR センサーログ
Microsoft Defender for Office 365
• インシデント情報
Microsoft Cloud App Security
• インシデント情報
Office 365
• Exchange アクティビティログ
• SharePoint アクティビティログ
• Teams アクティビティログ
39
Amazon Web Services（以下、AWS）
• CloudTrail ログ
なお Box と Netskope のログは、API を⽤いて Azure Sentinel に集約可能であったが、実装する基盤（AWS
Lambda）の AWS 環境調達と費⽤確定に要する調整期間が本事業の期間と折り合わなかったことから、実装を
⾒送っている。
分析クエリーの設定
集約したログを相関分析するために、Azure Sentinel がデフォルトで備えているクエリーのうち、本アーキテ
クチャで使⽤する各製品に対応したものを有効化する。特に、Microsoft 製品内での相関分析に留まらず、
Microsoft 製品と他製品との相関分析を実証するために、AWS 環境のログ(CloudTrail)との相関分析を⾏うクエ
リーテンプレートが利⽤可能なように構成している。
各クエリーの実⾏間隔は、クエリーの性質とクラウドの特性を鑑みて 1 時間〜24 時間間隔で実⾏するよう構
成している。
クエリーの性質は、アラートなどの単発での応答を要するものと、複数のデータソースをある程度のスパンで
集計した結果を相関分析するものに区別される。
クラウドの特性とは、クラウドサービスのログは必ずしもリアルタイムで発⾏・収集されるものではないとい
うものである。⼀概に断定はできないが、実際に⾏われた操作から 10〜15 分程度、クラウドサービスの稼働状
況によっては更に遅れたタイミングでコンソールでの確認やクエリーの実⾏が可能な状態となるサービスもあ
る。セキュリティイベント管理システムへの転送は、⼀定間隔で⾏われることを鑑みると、ログの発⾏から集約
までの時間は、最低でも 30 分〜1 時間を⾒込んでおく必要がある。単⼀のデータソースで 1 時間程度の遅れが
あることを鑑みると、複数のデータソースのログを相関分析する上では更に多くのリードタイムを⾒込んでおく
必要がある。
以上を踏まえてクエリーの実⾏間隔を決定した。
⾃動対応の設定
分析クエリーの検知結果にもとづいて、Azure Logic App で⾃動応答機能を構成する。⾃動応答機能は、検出
したクエリーの内容を Slack に通知するものをはじめに構成し、通知された内容やアラートの発⽣状況の傾向を
鑑みて、個別の⾃動応答機能を構成する⽅針とする。本事業では、個別の⾃動応答機能として、⼈に紐付かない
緊急⽤ユーザーの利⽤を Slack に通知するよう構成した。
なお Slack に通知する内容は、複数の検知でも流れにくくするよう、以下 3 項⽬に絞るよう構成している。
• 分析クエリー名
• 重要度
• アラート⼀覧へのリンク
40
検証に参加した利⽤者が少なかったこと、検証期間が限られていたことから、運⽤を簡易化する必要が⽣じる
ほどの検知は⾒受けられず、個別の⾃動応答機能を構成するには⾄っていない。
可視化テンプレートの設定
収集したログからアクティビティを可視化するテンプレートを構成した。
可視化した内容は以下のとおりである。
Azure Active Directory 監査ログ
• ユーザー操作にもとづく API の発⾏状況と API のカテゴリランキング
• アクティビティが多いユーザー
• API の成功、失敗のトレンド
Azure Active Directory 監査、アクティビティ、サインインログ
• ログイン失敗理由の⽐率
• ログインタイプの変動推移
• ログインが成功したロケーションのランキング
• ログインが成功したアプリケーションのランキング
• API の種類毎の成功レートとトレンド
• API の種類毎の失敗レートとトレンド
• 直近の監査ログ
• Azure 上でのオペレーション内容のレートとトレンド
Azure Active Directory サインインログ
• サインインの国別ランキングとトレンド
• サインインのデバイス種別ランキングとトレンド
• 直近のサインインの動向
• 条件付きアクセスの成功・失敗の動向
• 条件付きアクセス失敗に係るエラー内容の動向
Exchange Online
• ユーザーアクティビティの時系列データ
• ユーザーアクティビティの⼀覧
• 管理者操作の⽐率
• 外部からの不審な操作の発⽣状況
• ユーザーによる⼿動削除の発⽣状況
• メールボックスに係る操作の発⽣状況
セキュリティイベントログ
• ユーザーログイン動向
• デバイスログイン動向
• セキュリティイベントログの⼀覧
• ログインタイプランキング
41
セキュリティ通知
• 重要度別発⽣件数
• セキュリティアラート発⾏元ランキングとトレンド
• セキュリティアラート発⾏の時系列データ
• セキュリティアラート発⾏元 IP アドレスのランキング
• セキュリティアラート発⽣元タイプの⽐率
データ収集の正常性監視
• データソースからのログ流⼊量ランキング
• ログ流⼊量の時系列データ
• 秒間データ件数ランキング
• 最後のデータ受信から期間が経っているデータソースランキング
AWS ユーザーアクティビティ
• サインインイベントの発⽣推移
• サインインの成功・失敗のトレンド
• コンソールや API による操作の⽐率
• AWS アカウント毎のユーザーアクティビティの動向
• リージョンごとの API 発⾏状況
• コンソール操作や API 発⾏元の User Agent のランキングと発⾏トレンド
AWS ネットワークアクティビティ
• リージョンごとのネットワーク流量
• API の発⾏ランキング
• ネットワークリソースの作成・削除イベントの⼀覧
• セキュリティグループとネットワーク ACL の変更イベントの⼀覧
本来であれば、ログ収集の⽬的やログ収集を通じて成したいこと、説明責任にもとづいて可視化を設計する
が、事業の期間を鑑みて Azure Sentinel がデフォルトで備えるテンプレートを⽤いてログの可視化を構成して
いる。
42
SIEM に係る検証結果
各種クラウドサービスから出⼒されるログとその相関分析ができ、個別に連携すべきアラートについては、
Slack 等を経由して通知を受け取ることが可能であることを確認できた。
2 - 3 . 本アーキテクチャ構築に係る提⾔
本事業では、DX オフィスが⽬指す構想を具現化する取り組みを⾏ってきた。本事業の遂⾏を通じて、⾏政組
織がクラウドファーストの原則に則って、モダンかつセキュアな業務インフラを構成する上で⾒出した現状のギ
ャップと、これから議論されるべき観点を提⾔としてまとめる。
2-3-1 . ⾏政組織におけるクラウドサービスの契約の課題
本事業を遂⾏するにあたり、さまざまなクラウドサービスを契約している。その際に直⾯した課題を以下に⽰
す。
（１）クラウドサービス契約におけるテナントオーナーと管理者の分離の課題
（２）クラウドサービス利⽤料の⽀払⽅法と賦課の課題
43
（３）従量課⾦の予算化の課題
（１）クラウドサービス契約におけるテナントオーナーと
管理者の分離の課題
課題
クラウドサービス契約の際に、テナントオーナーとして管理者を登録する必要がある。
しかし、管理者とテナントオーナーに求められる要件・操作については、必ずしも⼀致するものではない。
管理者は、クラウドサービスの利⽤規約の確認を求められることから、システムの責任者として⾏政側の担当
者を登録することが望ましい。
⼀⽅でテナントオーナーは、クラウドサービスのテナントを開設する際にメール送付される初期認証情報を受
信し、クラウドサービスの環境設定を⾏う関係者を登録する必要がある。
またクラウドサービスの種類によっては、テナントオーナーのみが管理者権限でも操作できない設定が許可さ
れているものも存在する。
そのためテナントオーナーと管理者が同⼀である場合、クラウドサービス操作に係る知識や慣れが要求される
操作についても、⾮技術者である⾏政の担当者がそれを担う場⾯が予想され、困難なケースがあると想定され
る。
また別の観点で、⾏政の担当者は⼀定期間で異動するため、クラウドサービスに対する重要な権限をもつユー
ザーの移管業務が定常的に発⽣することも忘れてはならない。
提⾔
本課題に対して、クラウドサービス事業者は、利⽤許諾を承認する担当者（管理者）とテナント上の特権作業
を担う担当者（テナントオーナー）を分けて登録可能とする⽅式をオプションとして⽤意する余地がある。
44
上記⽅式であれば、利⽤許諾の承認をもって、テナント上の特権作業をおこなう担当者に接続情報を送信する
構成が考えられる。⾮技術者である⾏政の担当者は、システムの責任を負うという本来の責任範囲で利⽤許諾の
承認⾏為を⾏うことができ、特権作業は受託ベンダーの担当者で速やかに実施できるものと考える。
（２）クラウドサービス利⽤料の⽀払⽅法と賦課の課題
課題
クラウドサービス契約の際に、⽀払⽅法としてクレジットカード情報の登録を要するものが多く存在する。
事業単位でクラウドサービスを提供する場合、応札事業者のクレジットカードを登録し、クラウドサービスで
発⽣する課⾦をクレジットカードにて、応札した予算の範囲内において決済する。
しかし、事業を横断するプラットフォームの場合、⾏政組織はクレジットカードを所有しないため、事業単位
同様に応札事業者のクレジットカードを登録せざるを得ないが、どの事業者のカードを登録するかが判然としな
い問題が⽣じる。
また、各事業で発⽣する費⽤の按分と賦課を⾏うための⽅式が確⽴されていないため、クレジットカードを登
録した事業者が費⽤を回収しきれない可能性が考えられる。
現時点では、事業毎にクラウドサービスのテナントを個別で⽤意する⽅式以外に選択肢がなく、結果としてク
ラウドサービスのテナントを個別調達する形となるため、構築作業などにおいても、既存テナントについて実施
済みの作業をテナントごとに都度再実施する必要がある。
提⾔
本課題に対して、クラウドサービス事業者は、テナント内のリソースから⽣じる課⾦を任意のサブスクリプシ
ョンに割り当てる⽅式を、オプションで⽤意する余地がある。
サブスクリプションに対して各事業のクレジットカードをそれぞれ登録することで、各事業の応札事業者は、
サブスクリプションに紐づくリソースに対しての課⾦額のみを⽀払うことが可能になると考えられる。
このような⽅式は、Microsoft Azure のリソース管理と課⾦⽅式が参考となる。
⼀⽅で、クラウドサービスのテナントを管理する担当者に負担が集中しないよう、事業および応札事業者間で
の利害を調整する枠組みについて議論する必要がある。
なお本提⾔に関連する報告が、内閣官房と総務省より「第⼆期政府共通プラットフォームにおけるクラウド
サービス調達とその契約に係る報告書」として報告されている。
詳細は以下 URL を参照すること。
https://cio.go.jp/node/2704
（３）従量課⾦の予算化の課題
45
課題
クラウドサービスの多くは従量課⾦モデルであるため、まだ実装されていないシステムの利⽤⾦額を予想する
ことは難しい。
クラウドサービスは、迅速に⼩さく利⽤を開始し、事業のスケールに伴って利⽤を拡⼤していくことに最⼤の
利点がある。
そのためシステムや予算のサイジングに時間や労⼒を要する状況は、本来期待できる効果が得られない状況と
⾔える。
クラウドファーストの原則に則って、⾏政における事業にクラウドサービスの利⽤を促進する上で、本課題は
重⼤な問題である。
提⾔
本課題に対して、⾏政は、調達の際に⼀括で予算の確定を求めるのではなく、⼀定期間のテストドライブの結
果に基づいた補正予算の申請を許容する⽅式を検討する余地がある。
⼊札は、テストドライブ期間中の予算と技術点・提案点・課題実現点で評価し、テストドライブ中の予算に対
して⼀定の係数を掛けた値を上限に補正予算の申請を許容することで、⼊札者のリスクやサイジングに伴う⼯数
をある程度コントロール可能できるものと考える。
2-3-2 . エンタイトルメント管理
本事業においては、ユーザーアカウントの管理は Azure Active Directory のみで実施している。Azure Active
Directory は⼤規模な組織の利⽤を前提とした機能をもっている。しかし組織の⼈事情報との連携、組織上の役
割と各種システムに対するアカウントの権限の割り当てなど、エンタイトルメント管理に課題がある。
課題
本アーキテクチャにおいて、⼈事システムとクラウドの認証基盤は、連携する仕組みが整備されていないのが
現状である。⼈事による職員の所属や職掌の情報から、認証基盤やクラウド・オンプレミスの各種サービスのア
カウントに対して連携する、いわゆるライフサイクル管理は標準化が不⼗分である。
認証基盤から各種サービスに連携するためのプロトコルとして SCIM が存在する。SCIM によるアカウントの
作成、更新、削除は可能でも、適切な権限のライフサイクル管理まで可能なクラウドサービスは少ない。SCIM
には未対応でも、独⾃の API を使うことで管理できるケースがあるが、クラウドサービスごとに機能の実装が個
別で必要になる。
API を使った管理ができないクラウドサービスもいまだ多く、そのようなクラウドサービスは管理者による⼿
作業での対応が必要になるため、管理コストが増⼤する傾向にある。
46
提⾔
クラウドサービスを中⼼に利⽤する本アーキテクチャでは、システム間連系が重要であるため、連携が容易で
ないクラウドサービスを選定しないことが重要である。また、利⽤が避けられないクラウドサービスに対して
は、連携が容易になるように、API を整備することなど改善するように要求することが望ましい。
なおエンタイトルメント管理の分野は未成熟であり、認証基盤のエンタイトルメント管理機能の充実だけでな
く、アイデンティティ制御を専⾨に⾏うシステムやサービス⾃体の拡充を期待したい。
2-3-3 . シークレットの管理
本事業において、BYOK で利⽤する暗号鍵（秘密鍵）の管理⽅法について検討した際に、いまだ最適解がな
く、多くの課題が明らかとなった。以下は暗号鍵のみならず、職員が利⽤するパスワードも含め、秘密にするべ
きデジタルデータのことを、ここではシークレットと表現し記述する。
組織または個⼈が管理するべきシークレットには、⽤途に応じて以下の 3 つに分類できる。
（１）システム管理者を除く⾏政側業務従事者が⽇常業務で利⽤するシークレット
（２）システム管理者が管理業務で利⽤するシークレット
（３）システム管理者が緊急時に利⽤するシークレット
(１) システム管理者を除く⾏政側業務従事者が⽇常業務で利⽤する
シークレット
⽇常業務に利⽤する、管理権限を持たないユーザーのアカウントの認証情報など、重要性が⾼くなく、利⽤頻
度が多いものが対象となる。
課題
現状は、各個⼈がもつシークレットを管理する⽅法が確⽴されていない。主なシークレットであるパスワード
の管理は、暗号化されていないテキストファイルに記録して端末内への保存や、⼿書きのメモに記録などといっ
た、安全性の低い⼿法によって管理されている。
提⾔
個々⼈がもつシークレットを管理するには、いわゆるパスワードマネージャを使うのが望ましい。パスワード
マネージャは、パスワードなどのシークレットを暗号化して保管・共有する機能を有する。
また、システム全体として可能な限りパスワードを減らす⽅向に向かうべきであり、例えばパスワードを使わ
ない認証⽅式である、パスワードレス認証の使⽤を推奨する。
47
パスワードレス認証のために、職員に FIDO 2.0 に対応したセキュリティキーを配布するのが望ましい。少な
くとも、管理職以上の役職者はセキュリティキーを必須にすることを推奨する。
(２) システム管理者が管理業務で利⽤するシークレット
システムの管理業務上必要になる⼤きな権限をもつアカウントの認証情報など、⽇常業務では利⽤しないが、
重要性が⾼く、複数⼈での共有が必要かつ利⽤頻度が⼤きいものが対象となる。
課題
システム管理者は重要な役割であるため、管理者が存在しない状態はリスクである。そのため必ず複数⼈をも
ってその任に当たるべきであるが、システムによっては、最上位権限をもつアカウントを複数作成できない場合
がある。その場合は、最上位権限をもつアカウントを個⼈に関連付けるのではなく、システム管理者間で共有す
るアカウントとして設定し、共有アカウントの認証情報をシステム管理者間で共有する必要がある。
提⾔
認証情報のようなシークレットを共有するには、シークレットを安全に共有する機能を有するパスワードマネ
ージャを利⽤する。ただしシークレットを共有すると、そのシークレットが漏えいするリスクが⼈数に⽐例して
⾼まる。そのため対策として、個々のシークレットに対するアクセスのログの記録、シークレットの不正利⽤の
検出、シークレットを利⽤する際の承認を必須にするためのワークフローなどの機能が利⽤できる必要がある。
またシステム管理者の増減により、シークレットの共有範囲が変わる際には、共有しているシークレットを変
更する運⽤を定義する必要がある。
加えて、シークレットを共有しなければならない状況そのものを回避するため、利⽤するクラウドサービスに
ついては、最上位権限を複数のアカウントに付与できるものを選定することが望ましい。
その他、認証システムは、このようなユースケースのための共有アカウントを利⽤する際に、シークレットを
共有することなくアカウントを利⽤できる代理認証のような仕組みをもっていることが望ましい。
(３) システム管理者が緊急時に利⽤するシークレット
BYOK で使う秘密鍵（暗号鍵）や、緊急アクセス⽤管理アカウントの認証情報など、通常業務では利⽤せず、
緊急時にのみ必要となるものが対象となる。
課題
通常業務で利⽤せず、かつ重要性や緊急性が⾼いシークレットは、広義の⾏政⽂書に当たると考えられる。し
かし現在はこのような情報を管理する適切な仕組みが存在しない。
48
提⾔
本アーキテクチャでは、紙媒体に記録して銀⾏の貸⾦庫や組織内の⾦庫に暗号鍵を保管する⼿法を検討した。
このような情報を保管する仕組み、管理プロセスについては、法整備が必要である。
暗号鍵は⾮常に重要な情報であるため、適切なアクセスコントロールと継続した保管を前提とした機構が必要
である。また緊急時の利⽤が想定されるため、適切な権限をもつ利⽤者が、利⽤の申請と承認、情報の取得が迅
速に⾏える仕組みであるべきである。同時に、災害時などに情報が失われないように、分散保存をする必要があ
る。
2-3-4 . Box KeySafe の実装に係る⼿続き
課題
Box KeySafe は、Box のデータを利⽤者が⽤意した鍵を⽤いて暗号化するものである。
Box KeySafe の設定は、Box テナント内の緻密な設定変更や調整が伴うため、Box 社のエンジニアによるコ
ンサルティング⽀援を受ける必要がある。
また Box テナントの所有者は、暗号鍵をホストする環境を AWS 上に作成する必要があり、⽤意した環境の情
報を Box 社に引き渡すなどの調整を⾏う必要がある。
本事業では、これらの調整や課題解決に多くの時間を要する状況が⾒て取れた。
まず Box KeySafe の契約関連の調整完了後、Box 社のエンジニアのアサインまで 1 ヶ⽉を要した。
アサイン後のやり取り⼀つひとつの応対に 5 営業⽇以上の待ち時間が発⽣するなど、コミュニケーション⾯
での時間的なオーバーヘッドが多く⾒受けられた。
これらにより最終的に、Box KeySafe の契約から実装完了までに約 3 ヶ⽉を費やした。
提⾔
Box KeySafe を採⽤する応札事業者は、⼗分な時間的余裕をもって実装スケジュールを組むことが求められ
る。
49
2-3-5 . アラート対応⾃動化の実装最適化
課題
本事業では、Microsoft Azure Sentinel を⽤いて、SIEM 機能で本来⾏うべきログ集約と相関分析機能の実装
に加えて、各種セキュリティ機構のアラートの集約と通知機構の実装を⾏っている。
また Microsoft Azure Sentinel は⾃動化機能を有しており、定型的な初期調査や暫定処置など、アラートの内
容に応じた作り込みを⾏うことが可能である。
⼀⽅でアラートの検出傾向は、システムを利⽤する組織の運⽤⽅式やデータの取り扱い⽅式などの運⽤状況に
左右されるため、運⽤開始前に⾏える⼀般的な⾃動化機能の実装の最適化は極めて限定的である。
例えば構築期間と運⽤開始期間に⽐較的開きがある場合では、先んじて作り込みを⾏うケースが考えられる
が、アラートの調査の仕⽅は扱うシステムによって異なるため、利便性の向上に繋がらない、いわゆる“的外れ
な実装”になることが予想される。
そのため従来のウォーターフォール型の開発モデルでは、システムの特性や利⽤状況に則した効果的な⾃動化
機能の実装最適化を⾏うことが⾮常に難しい。
提⾔
構築期間中に⾏う SIEM 機能の⾃動対応についての実装最適化は最低限に留め、運⽤開始後にアラートの検出
傾向と調査⽅式を鑑みた上で順次⾏っていくことが、有効かつ効率的な実装の最適化を⾏う上で必要となる。
加えて、実装の最適化を実施する事業者とアラート対応や調査を⾏う事業者が異なる場合、実装の最適化を実
施する事業者の担当者は、アラート対応を実施する事業者の担当者の調査対応プロセスを観察し、調査対応を⾏
うオペレーションや利⽤者とのコミュニケーションを簡略化するアプローチで実装の最適化を⾏うことが望まし
い。また、アラート対応を実施する事業者の担当者は、実装の最適化を実施する担当者に対して、実装されたシ
ステムの最適化を、利⽤した結果としてフィードバックし、運⽤利便性を継続的に向上させていくことが求めら
れる。
50
上記のように、継続的な開発・改善プロセスを⾏う必要があることから、開発モデルはアジャイル⽅式を⽤い
ることが望ましい。
そのため調達仕様を作成する⾏政の担当者は、運⽤期間中に継続的な開発と改善を無理なく実施できるよう、
調達仕様の記載に留意することが求められる。
